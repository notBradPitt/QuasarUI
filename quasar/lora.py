import quasar.utils
EuHyvrpwwuVKxUBFXTBYJgpzXBoaVRiK = {
    "mlp.fc1": "mlp_fc1",
    "mlp.fc2": "mlp_fc2",
    "self_attn.k_proj": "self_attn_k_proj",
    "self_attn.q_proj": "self_attn_q_proj",
    "self_attn.v_proj": "self_attn_v_proj",
    "self_attn.out_proj": "self_attn_out_proj",
}
def SrmfspByOhxEpYfUbHxdWOzxdGzupQxv(nIzLGXVwazNtJWADcRXQeGTPYhxWppqT, nOrtXSpMTcWOSkkcnhMSnuMMVQqbTRkc):
    VsWtfnhmMMNIIbKyNppCPafnkWSwofhA = {}
    NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy = set()
    for NECAaWUrFGIXcLimrerEYmxYIykQBfXb in nOrtXSpMTcWOSkkcnhMSnuMMVQqbTRkc:
        uYBmPutzjvKKSpIRLvQKQIxUlVJYMFPC = "{}.alpha".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        uigKGapaQVcFiOjEiWwRAHjjkAWxsqck = None
        if uYBmPutzjvKKSpIRLvQKQIxUlVJYMFPC in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            uigKGapaQVcFiOjEiWwRAHjjkAWxsqck = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[uYBmPutzjvKKSpIRLvQKQIxUlVJYMFPC].ygFiYnqtfEqFJmbillPxtHRxsUoFqqJk()
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(uYBmPutzjvKKSpIRLvQKQIxUlVJYMFPC)
        OwGxJDHGSyFYelPJtQreVzxtJVqQlMXW = "{}.lora_up.weight".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        SkygvNtoewXcbSGIfzmPMnaCofWkQtvX = "{}_lora.up.weight".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        NcfPGrhqNWBCnXogCWfAuLSOtRPeXfxB = "{}.lora_linear_layer.up.weight".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        ldiHSGxiehhZLUEdHvMWZshfTiORMrck = None
        if OwGxJDHGSyFYelPJtQreVzxtJVqQlMXW in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            ldiHSGxiehhZLUEdHvMWZshfTiORMrck = OwGxJDHGSyFYelPJtQreVzxtJVqQlMXW
            eFYOPkWLLuKiJksSXczppadKnTroHuHy = "{}.lora_down.weight".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
            IkxagutaDGjJeaBCVJLGPPNRpaePolQR = "{}.lora_mid.weight".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        elif SkygvNtoewXcbSGIfzmPMnaCofWkQtvX in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            ldiHSGxiehhZLUEdHvMWZshfTiORMrck = SkygvNtoewXcbSGIfzmPMnaCofWkQtvX
            eFYOPkWLLuKiJksSXczppadKnTroHuHy = "{}_lora.down.weight".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
            IkxagutaDGjJeaBCVJLGPPNRpaePolQR = None
        elif NcfPGrhqNWBCnXogCWfAuLSOtRPeXfxB in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            ldiHSGxiehhZLUEdHvMWZshfTiORMrck = NcfPGrhqNWBCnXogCWfAuLSOtRPeXfxB
            eFYOPkWLLuKiJksSXczppadKnTroHuHy ="{}.lora_linear_layer.down.weight".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
            IkxagutaDGjJeaBCVJLGPPNRpaePolQR = None
        if ldiHSGxiehhZLUEdHvMWZshfTiORMrck is not None:
            rnBVwgYeGkHoRDXjLPBaCTIXNAZYBHGr = None
            if IkxagutaDGjJeaBCVJLGPPNRpaePolQR is not None and IkxagutaDGjJeaBCVJLGPPNRpaePolQR in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
                rnBVwgYeGkHoRDXjLPBaCTIXNAZYBHGr = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[IkxagutaDGjJeaBCVJLGPPNRpaePolQR]
                NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(IkxagutaDGjJeaBCVJLGPPNRpaePolQR)
            VsWtfnhmMMNIIbKyNppCPafnkWSwofhA[nOrtXSpMTcWOSkkcnhMSnuMMVQqbTRkc[NECAaWUrFGIXcLimrerEYmxYIykQBfXb]] = (nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[ldiHSGxiehhZLUEdHvMWZshfTiORMrck], nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[eFYOPkWLLuKiJksSXczppadKnTroHuHy], uigKGapaQVcFiOjEiWwRAHjjkAWxsqck, rnBVwgYeGkHoRDXjLPBaCTIXNAZYBHGr)
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(ldiHSGxiehhZLUEdHvMWZshfTiORMrck)
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(eFYOPkWLLuKiJksSXczppadKnTroHuHy)
        JaDEaxbkIBEwmPpNXmoxZRrDQcLOyHaE = "{}.hada_w1_a".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        UpTqzrhcDjdzqZBIvJHSlozSNjQYEiuu = "{}.hada_w1_b".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        qcfNVBfyGtzNBxEjYIGfaZaPKkfdjDhz = "{}.hada_w2_a".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        XlpVHCSfakzMdShAYiebVQYDGLrvYRKY = "{}.hada_w2_b".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        CoZiaRXKrqUPqDGgTNgAiXPTiiWoHxvk = "{}.hada_t1".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        foeJdtuzzoEPNIIeacDNbQJlxJxzLjgc = "{}.hada_t2".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        if JaDEaxbkIBEwmPpNXmoxZRrDQcLOyHaE in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            mhnxgxkCBEvWqXpHFDKCutxERQMiWYPa = None
            RdQdMVfMmFguLmedBwmiskRsVILiOJjv = None
            if CoZiaRXKrqUPqDGgTNgAiXPTiiWoHxvk in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
                mhnxgxkCBEvWqXpHFDKCutxERQMiWYPa = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[CoZiaRXKrqUPqDGgTNgAiXPTiiWoHxvk]
                RdQdMVfMmFguLmedBwmiskRsVILiOJjv = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[foeJdtuzzoEPNIIeacDNbQJlxJxzLjgc]
                NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(CoZiaRXKrqUPqDGgTNgAiXPTiiWoHxvk)
                NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(foeJdtuzzoEPNIIeacDNbQJlxJxzLjgc)
            VsWtfnhmMMNIIbKyNppCPafnkWSwofhA[nOrtXSpMTcWOSkkcnhMSnuMMVQqbTRkc[NECAaWUrFGIXcLimrerEYmxYIykQBfXb]] = (nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[JaDEaxbkIBEwmPpNXmoxZRrDQcLOyHaE], nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[UpTqzrhcDjdzqZBIvJHSlozSNjQYEiuu], uigKGapaQVcFiOjEiWwRAHjjkAWxsqck, nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[qcfNVBfyGtzNBxEjYIGfaZaPKkfdjDhz], nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[XlpVHCSfakzMdShAYiebVQYDGLrvYRKY], mhnxgxkCBEvWqXpHFDKCutxERQMiWYPa, RdQdMVfMmFguLmedBwmiskRsVILiOJjv)
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(JaDEaxbkIBEwmPpNXmoxZRrDQcLOyHaE)
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(UpTqzrhcDjdzqZBIvJHSlozSNjQYEiuu)
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(qcfNVBfyGtzNBxEjYIGfaZaPKkfdjDhz)
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(XlpVHCSfakzMdShAYiebVQYDGLrvYRKY)
        oOXbTPXUXYbIzxqsgvUgWXaJyIjSnpLj = "{}.lokr_w1".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        ClROjzCyhXevnKVAeAacYtFTDzWAaiiV = "{}.lokr_w2".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        dkQdKfhLpxJqlwDAEJQJJIHoZUCMHUEG = "{}.lokr_w1_a".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        BLmQPLITNuARaAtBHTDhmzkrjEbLSHGL = "{}.lokr_w1_b".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        zCXUHEbKiMkRAezXcxvvgGeMjQIkwZXM = "{}.lokr_t2".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        GBSefgUPjhXrfrtLrfNHGdQvCgzxLwaX = "{}.lokr_w2_a".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        QRWKfgITalclZybHHjYtgLuZGJcfoYmT = "{}.lokr_w2_b".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        VWwzEGgTNorANgtwUTbFaQXbYGmiMZaS = None
        if oOXbTPXUXYbIzxqsgvUgWXaJyIjSnpLj in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            VWwzEGgTNorANgtwUTbFaQXbYGmiMZaS = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[oOXbTPXUXYbIzxqsgvUgWXaJyIjSnpLj]
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(oOXbTPXUXYbIzxqsgvUgWXaJyIjSnpLj)
        WCzEgYlVrkemOHsHcQxGkdVNrBLYjahk = None
        if ClROjzCyhXevnKVAeAacYtFTDzWAaiiV in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            WCzEgYlVrkemOHsHcQxGkdVNrBLYjahk = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[ClROjzCyhXevnKVAeAacYtFTDzWAaiiV]
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(ClROjzCyhXevnKVAeAacYtFTDzWAaiiV)
        ehyCSCkBammDAlIFNoKMMdqMaVzlFzSN = None
        if dkQdKfhLpxJqlwDAEJQJJIHoZUCMHUEG in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            ehyCSCkBammDAlIFNoKMMdqMaVzlFzSN = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[dkQdKfhLpxJqlwDAEJQJJIHoZUCMHUEG]
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(dkQdKfhLpxJqlwDAEJQJJIHoZUCMHUEG)
        iruElyyPWyWuKzkEkqsWuAwtVKUczqHN = None
        if BLmQPLITNuARaAtBHTDhmzkrjEbLSHGL in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            iruElyyPWyWuKzkEkqsWuAwtVKUczqHN = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[BLmQPLITNuARaAtBHTDhmzkrjEbLSHGL]
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(BLmQPLITNuARaAtBHTDhmzkrjEbLSHGL)
        NoXwPwRYoTYwxAEUdaWmuiJYRXjrtyoq = None
        if GBSefgUPjhXrfrtLrfNHGdQvCgzxLwaX in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            NoXwPwRYoTYwxAEUdaWmuiJYRXjrtyoq = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[GBSefgUPjhXrfrtLrfNHGdQvCgzxLwaX]
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(GBSefgUPjhXrfrtLrfNHGdQvCgzxLwaX)
        iBaAugeqYzmbaDSsPxjnOgOQckbNIIaQ = None
        if QRWKfgITalclZybHHjYtgLuZGJcfoYmT in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            iBaAugeqYzmbaDSsPxjnOgOQckbNIIaQ = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[QRWKfgITalclZybHHjYtgLuZGJcfoYmT]
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(QRWKfgITalclZybHHjYtgLuZGJcfoYmT)
        qFgsbaDwvoJFNUUkRMJWepUHGBGXgbNn = None
        if zCXUHEbKiMkRAezXcxvvgGeMjQIkwZXM in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
            qFgsbaDwvoJFNUUkRMJWepUHGBGXgbNn = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT[zCXUHEbKiMkRAezXcxvvgGeMjQIkwZXM]
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(zCXUHEbKiMkRAezXcxvvgGeMjQIkwZXM)
        if (VWwzEGgTNorANgtwUTbFaQXbYGmiMZaS is not None) or (WCzEgYlVrkemOHsHcQxGkdVNrBLYjahk is not None) or (ehyCSCkBammDAlIFNoKMMdqMaVzlFzSN is not None) or (NoXwPwRYoTYwxAEUdaWmuiJYRXjrtyoq is not None):
            VsWtfnhmMMNIIbKyNppCPafnkWSwofhA[nOrtXSpMTcWOSkkcnhMSnuMMVQqbTRkc[NECAaWUrFGIXcLimrerEYmxYIykQBfXb]] = (VWwzEGgTNorANgtwUTbFaQXbYGmiMZaS, WCzEgYlVrkemOHsHcQxGkdVNrBLYjahk, uigKGapaQVcFiOjEiWwRAHjjkAWxsqck, ehyCSCkBammDAlIFNoKMMdqMaVzlFzSN, iruElyyPWyWuKzkEkqsWuAwtVKUczqHN, NoXwPwRYoTYwxAEUdaWmuiJYRXjrtyoq, iBaAugeqYzmbaDSsPxjnOgOQckbNIIaQ, qFgsbaDwvoJFNUUkRMJWepUHGBGXgbNn)
        YwSqxpxiHgBiVzmmmfCHNWItcaarToMT = "{}.w_norm".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        MTJYObABgtSXwgVvGmfvhoUmHdPbmVrJ = "{}.b_norm".format(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        DvAoFkQDutNZoxrbFGCcdHKoRJyTpgGd = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.get(YwSqxpxiHgBiVzmmmfCHNWItcaarToMT, None)
        BMReWNCIgeNfOCmRZPFkcrlrvGRWwgcG = nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.get(MTJYObABgtSXwgVvGmfvhoUmHdPbmVrJ, None)
        if DvAoFkQDutNZoxrbFGCcdHKoRJyTpgGd is not None:
            NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(YwSqxpxiHgBiVzmmmfCHNWItcaarToMT)
            VsWtfnhmMMNIIbKyNppCPafnkWSwofhA[nOrtXSpMTcWOSkkcnhMSnuMMVQqbTRkc[NECAaWUrFGIXcLimrerEYmxYIykQBfXb]] = (DvAoFkQDutNZoxrbFGCcdHKoRJyTpgGd,)
            if BMReWNCIgeNfOCmRZPFkcrlrvGRWwgcG is not None:
                NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy.add(MTJYObABgtSXwgVvGmfvhoUmHdPbmVrJ)
                VsWtfnhmMMNIIbKyNppCPafnkWSwofhA["{}.bias".format(nOrtXSpMTcWOSkkcnhMSnuMMVQqbTRkc[NECAaWUrFGIXcLimrerEYmxYIykQBfXb][:-len(".weight")])] = (BMReWNCIgeNfOCmRZPFkcrlrvGRWwgcG,)
    for NECAaWUrFGIXcLimrerEYmxYIykQBfXb in nIzLGXVwazNtJWADcRXQeGTPYhxWppqT.keys():
        if NECAaWUrFGIXcLimrerEYmxYIykQBfXb not in NmgXuVFZUthCLeDSKnqVuYTjzTcQCPEy:
            print("lora key not loaded", NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
    return VsWtfnhmMMNIIbKyNppCPafnkWSwofhA
def YGVReEJPYAdndbdMUyPaWQfkhNugOGOd(VrbJByPOrwLhVLYeJgcqPdGZIrgKHzRM, key_map={}):
    bDzYcwwumtZFgoQpDdqTHPZiuoEFrwAl = VrbJByPOrwLhVLYeJgcqPdGZIrgKHzRM.TQRgUMPjEwYAaDvSuzgvheADStCoUKzT().keys()
    IcJRPNMjWxQLVlgkPRXRyiVqDCcyEOcJ = "lora_te_text_model_encoder_layers_{}_{}"
    EQZwGemKvehFGDXyaGasZiPcUAonleJa = False
    for b in range(32):
        for cjHIelcAqVoHWdLcgzuZiBumKNTVADsY in EuHyvrpwwuVKxUBFXTBYJgpzXBoaVRiK:
            EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm = "transformer.text_model.encoder.layers.{}.{}.weight".format(b, cjHIelcAqVoHWdLcgzuZiBumKNTVADsY)
            if EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm in bDzYcwwumtZFgoQpDdqTHPZiuoEFrwAl:
                msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = IcJRPNMjWxQLVlgkPRXRyiVqDCcyEOcJ.format(b, EuHyvrpwwuVKxUBFXTBYJgpzXBoaVRiK[cjHIelcAqVoHWdLcgzuZiBumKNTVADsY])
                key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
                msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "lora_te1_text_model_encoder_layers_{}_{}".format(b, EuHyvrpwwuVKxUBFXTBYJgpzXBoaVRiK[cjHIelcAqVoHWdLcgzuZiBumKNTVADsY])
                key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
                msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "text_encoder.text_model.encoder.layers.{}.{}".format(b, cjHIelcAqVoHWdLcgzuZiBumKNTVADsY) 
                key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
            EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm = "clip_l.transformer.text_model.encoder.layers.{}.{}.weight".format(b, cjHIelcAqVoHWdLcgzuZiBumKNTVADsY)
            if EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm in bDzYcwwumtZFgoQpDdqTHPZiuoEFrwAl:
                msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "lora_te1_text_model_encoder_layers_{}_{}".format(b, EuHyvrpwwuVKxUBFXTBYJgpzXBoaVRiK[cjHIelcAqVoHWdLcgzuZiBumKNTVADsY]) 
                key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
                EQZwGemKvehFGDXyaGasZiPcUAonleJa = True
                msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "text_encoder.text_model.encoder.layers.{}.{}".format(b, cjHIelcAqVoHWdLcgzuZiBumKNTVADsY) 
                key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
            EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm = "clip_g.transformer.text_model.encoder.layers.{}.{}.weight".format(b, cjHIelcAqVoHWdLcgzuZiBumKNTVADsY)
            if EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm in bDzYcwwumtZFgoQpDdqTHPZiuoEFrwAl:
                if EQZwGemKvehFGDXyaGasZiPcUAonleJa:
                    msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "lora_te2_text_model_encoder_layers_{}_{}".format(b, EuHyvrpwwuVKxUBFXTBYJgpzXBoaVRiK[cjHIelcAqVoHWdLcgzuZiBumKNTVADsY]) 
                    key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
                    msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "text_encoder_2.text_model.encoder.layers.{}.{}".format(b, cjHIelcAqVoHWdLcgzuZiBumKNTVADsY) 
                    key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
                else:
                    msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "lora_te_text_model_encoder_layers_{}_{}".format(b, EuHyvrpwwuVKxUBFXTBYJgpzXBoaVRiK[cjHIelcAqVoHWdLcgzuZiBumKNTVADsY]) 
                    key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
                    msfMFNSVYRhKIFWtgzRsldFAxORgYGBk = "text_encoder.text_model.encoder.layers.{}.{}".format(b, cjHIelcAqVoHWdLcgzuZiBumKNTVADsY) 
                    key_map[msfMFNSVYRhKIFWtgzRsldFAxORgYGBk] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
    return key_map
def ksOxPDpImpogBSzupOdRcjgZpJBeUpBC(VrbJByPOrwLhVLYeJgcqPdGZIrgKHzRM, key_map={}):
    bDzYcwwumtZFgoQpDdqTHPZiuoEFrwAl = VrbJByPOrwLhVLYeJgcqPdGZIrgKHzRM.TQRgUMPjEwYAaDvSuzgvheADStCoUKzT().keys()
    for EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm in bDzYcwwumtZFgoQpDdqTHPZiuoEFrwAl:
        if EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm.startswith("diffusion_model.") and EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm.endswith(".weight"):
            LKJdGZgvLdtHbTaHSkwPNbDmfDNeizgT = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm[len("diffusion_model."):-len(".weight")].replace(".", "_")
            key_map["lora_unet_{}".format(LKJdGZgvLdtHbTaHSkwPNbDmfDNeizgT)] = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm
    HrtjFPTyNnkcmhLsoJQXqFqnticsQeZI = quasar.utils.unet_to_diffusers(VrbJByPOrwLhVLYeJgcqPdGZIrgKHzRM.QndHjlfwhEimYkuHnNTDxkEXYaCwJdZe.lLgbOYEeDmYyyxASAROATrPmlqgqYORG)
    for EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm in HrtjFPTyNnkcmhLsoJQXqFqnticsQeZI:
        if EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm.endswith(".weight"):
            ZLsoiSDFKYjFFAyHNnaPvmlbSAUmwwSC = "diffusion_model.{}".format(HrtjFPTyNnkcmhLsoJQXqFqnticsQeZI[EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm])
            LKJdGZgvLdtHbTaHSkwPNbDmfDNeizgT = EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm[:-len(".weight")].replace(".", "_")
            key_map["lora_unet_{}".format(LKJdGZgvLdtHbTaHSkwPNbDmfDNeizgT)] = ZLsoiSDFKYjFFAyHNnaPvmlbSAUmwwSC
            NPCjLVyWKMWKTBprADqMqvceyGbdDOzb = ["", "unet."]
            for HutkrxeXIuRQKOhCWHkiwqLGAsJjUSKj in NPCjLVyWKMWKTBprADqMqvceyGbdDOzb:
                DFYjIiAxmZiLymbMrxdtfQFXtpNpcCeT = "{}{}".format(HutkrxeXIuRQKOhCWHkiwqLGAsJjUSKj, EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm[:-len(".weight")].replace(".to_", ".processor.to_"))
                if DFYjIiAxmZiLymbMrxdtfQFXtpNpcCeT.endswith(".to_out.0"):
                    DFYjIiAxmZiLymbMrxdtfQFXtpNpcCeT = DFYjIiAxmZiLymbMrxdtfQFXtpNpcCeT[:-2]
                key_map[DFYjIiAxmZiLymbMrxdtfQFXtpNpcCeT] = ZLsoiSDFKYjFFAyHNnaPvmlbSAUmwwSC
    return key_map
