    Args:
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb: (oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV, vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)
        nutobJTmWCYYpulsyYOoRWLklenNVeiu (int): window vqDBJgidQufnKyAltPYRqiKGjmztArDJ
    Returns:
        windows: (num_windows*oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, nutobJTmWCYYpulsyYOoRWLklenNVeiu, nutobJTmWCYYpulsyYOoRWLklenNVeiu, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)
    Args:
        windows: (num_windows*oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, nutobJTmWCYYpulsyYOoRWLklenNVeiu, nutobJTmWCYYpulsyYOoRWLklenNVeiu, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)
        nutobJTmWCYYpulsyYOoRWLklenNVeiu (int): Window vqDBJgidQufnKyAltPYRqiKGjmztArDJ
        gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV (int): Height of eLyJtroPthPCROYWyMphoIrGatNOOXCO
        vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ (int): Width of eLyJtroPthPCROYWyMphoIrGatNOOXCO
    Returns:
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb: (oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV, vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)
    def __init__(
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS,
        yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk,
        nutobJTmWCYYpulsyYOoRWLklenNVeiu,
        WbSAuusmaEgbrureofeJezeXtfsVoscC,
        uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT=True,
        tGJGoWYafTzhRETOOrClZjPpgXFZUOzU=0.0,
        hjPwvODBKgggBiPujNmVDnfSDUrbQIXL=0.0,
        fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn=[0, 0],
    ):
        super().__init__()
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk = yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu = nutobJTmWCYYpulsyYOoRWLklenNVeiu  
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn = fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC = WbSAuusmaEgbrureofeJezeXtfsVoscC
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.jxsdqpxmkwPEoWHYaPqDyiSfcKiGpgdp = nn.Parameter(torch.DJwhOGBaLcOjmXnuwXMXOyhMtknqkKXL(10 * torch.ones((WbSAuusmaEgbrureofeJezeXtfsVoscC, 1, 1))), requires_grad=True)  
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.cpb_mlp = nn.Sequential(
            nn.DhMcMyEvvzmWIEJojbQeGHlzfZKiPzHO(2, 512, PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB=True),
            nn.ReLU(inplace=True),
            nn.DhMcMyEvvzmWIEJojbQeGHlzfZKiPzHO(512, WbSAuusmaEgbrureofeJezeXtfsVoscC, PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB=False),
        )
        crlmNhhGBDGQPlCCLGZRPMtkhtDcewcG = torch.arange(
            -(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[0] - 1), rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[0], DDRQlhrNSGpwTrokWitkZipdfbAqBFxv=torch.float32
        )
        pUmBUOipsPMQQtRxYPkXghIkwFHAIdFM = torch.arange(
            -(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1] - 1), rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1], DDRQlhrNSGpwTrokWitkZipdfbAqBFxv=torch.float32
        )
        uUqKtpAFtenspQYksdVQigMzkvnUGsAS = (
            torch.stack(torch.meshgrid([crlmNhhGBDGQPlCCLGZRPMtkhtDcewcG, pUmBUOipsPMQQtRxYPkXghIkwFHAIdFM]))
            .permute(1, 2, 0)
            .contiguous()
            .unsqueeze(0)
        )  
        if fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn[0] > 0:
            uUqKtpAFtenspQYksdVQigMzkvnUGsAS[:, :, :, 0] /= fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn[0] - 1
            uUqKtpAFtenspQYksdVQigMzkvnUGsAS[:, :, :, 1] /= fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn[1] - 1
        else:
            uUqKtpAFtenspQYksdVQigMzkvnUGsAS[:, :, :, 0] /= rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[0] - 1
            uUqKtpAFtenspQYksdVQigMzkvnUGsAS[:, :, :, 1] /= rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1] - 1
        uUqKtpAFtenspQYksdVQigMzkvnUGsAS *= 8  
        uUqKtpAFtenspQYksdVQigMzkvnUGsAS = (
            torch.HBMNcZPXMGfIKnBsvnouXucWvkUmgWwq(uUqKtpAFtenspQYksdVQigMzkvnUGsAS)
            * torch.log2(torch.abs(uUqKtpAFtenspQYksdVQigMzkvnUGsAS) + 1.0)
            / np.log2(8)
        )
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.BpOtVuSttURsCNYELWmrxpBkqOPYBBlj("relative_coords_table", uUqKtpAFtenspQYksdVQigMzkvnUGsAS)
        HWcEeGtBJtpOChhCnNTOPoGJYugATHVi = torch.arange(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[0])
        lslaUtgDIUhsMqGwoodDkFdnnUaajlOH = torch.arange(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1])
        jbKWsVJoZAEQliICCLiLwJEyKLeiQKao = torch.stack(torch.meshgrid([HWcEeGtBJtpOChhCnNTOPoGJYugATHVi, lslaUtgDIUhsMqGwoodDkFdnnUaajlOH]))  
        LpMPNzJBbTIafGKEoMlfJAYESjxwvwJu = torch.flatten(jbKWsVJoZAEQliICCLiLwJEyKLeiQKao, 1)  
        xUtSxqTWrKPLWSsgdjbVmdBZqgCgUkXg = (
            LpMPNzJBbTIafGKEoMlfJAYESjxwvwJu[:, :, None] - LpMPNzJBbTIafGKEoMlfJAYESjxwvwJu[:, None, :]
        )  
        xUtSxqTWrKPLWSsgdjbVmdBZqgCgUkXg = xUtSxqTWrKPLWSsgdjbVmdBZqgCgUkXg.permute(
            1, 2, 0
        ).contiguous()  
        xUtSxqTWrKPLWSsgdjbVmdBZqgCgUkXg[:, :, 0] += rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[0] - 1  
        xUtSxqTWrKPLWSsgdjbVmdBZqgCgUkXg[:, :, 1] += rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1] - 1
        xUtSxqTWrKPLWSsgdjbVmdBZqgCgUkXg[:, :, 0] *= 2 * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1] - 1
        oRUZBArRhEMoqHYrzRoSroQpwOYCIvBp = xUtSxqTWrKPLWSsgdjbVmdBZqgCgUkXg.sum(-1)  
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.BpOtVuSttURsCNYELWmrxpBkqOPYBBlj("relative_position_index", oRUZBArRhEMoqHYrzRoSroQpwOYCIvBp)
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ = nn.DhMcMyEvvzmWIEJojbQeGHlzfZKiPzHO(yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk, yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk * 3, PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB=False)
        if uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT:
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.q_bias = nn.Parameter(torch.zeros(yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk))  
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.v_bias = nn.Parameter(torch.zeros(yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk))  
        else:
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.q_bias = None
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.v_bias = None
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.tGJGoWYafTzhRETOOrClZjPpgXFZUOzU = nn.Dropout(tGJGoWYafTzhRETOOrClZjPpgXFZUOzU)
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.proj = nn.DhMcMyEvvzmWIEJojbQeGHlzfZKiPzHO(yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk, yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk)
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.hjPwvODBKgggBiPujNmVDnfSDUrbQIXL = nn.Dropout(hjPwvODBKgggBiPujNmVDnfSDUrbQIXL)
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.softmax = nn.Softmax(yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk=-1)
    def lqBgIcSWZYylbCPjXksJWDguuSOqoPCJ(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, NECAaWUrFGIXcLimrerEYmxYIykQBfXb, KHpRlHOzblljQyskecSxzUuWZtneWwta=None):
        qNFDCcJCurubqgfYKilsAnvvBJnmzOLl, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh = NECAaWUrFGIXcLimrerEYmxYIykQBfXb.BElyDvcGzbvMmmwmYRGBIJogcxsyYZSg
        uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT = None
        if rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.q_bias is not None:
            uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT = torch.cat((rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.q_bias, torch.zeros_like(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.v_bias, requires_grad=False), rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.v_bias))  
        unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ = F.BJkSsAwbTZLfucgvGkDLcVEiRIlYJCmK(input=NECAaWUrFGIXcLimrerEYmxYIykQBfXb, RXBOtvKSHQkBvdKDbckmnlphvVygYURP=rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ.RXBOtvKSHQkBvdKDbckmnlphvVygYURP, PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB=uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT)
        unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ = unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ.reshape(qNFDCcJCurubqgfYKilsAnvvBJnmzOLl, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts, 3, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC, -1).permute(2, 0, 3, 1, 4)
        mxaMgfLZUDPObiqkdCgHnnARjBNVGQnh, EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm, powGafreWfwlSAqPpTpUhFgpFVqCPavl = (
            unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ[0],
            unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ[1],
            unQNqNyaXZtDbRPdnrUuajLjwVMuGeHZ[2],
        )  
        tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = F.normalize(mxaMgfLZUDPObiqkdCgHnnARjBNVGQnh, yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk=-1) @ F.normalize(EWOrdNFMIwTeWNNYWAYyRJvhctFfHPqm, yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk=-1).transpose(-2, -1)
        jxsdqpxmkwPEoWHYaPqDyiSfcKiGpgdp = torch.clamp(
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.jxsdqpxmkwPEoWHYaPqDyiSfcKiGpgdp,
            max=torch.DJwhOGBaLcOjmXnuwXMXOyhMtknqkKXL(torch.xPmCFphFKpGMpIsczaSKHmMgRPZzJwla(1.0 / 0.01)).sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.jxsdqpxmkwPEoWHYaPqDyiSfcKiGpgdp.fncUdpUPRXGoRKeawVhmqjlxVPGbdjmc),
        ).exp()
        tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW * jxsdqpxmkwPEoWHYaPqDyiSfcKiGpgdp
        psppIXxCSyAsmPWaeuPeRLTPCwLBFIOe = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.cpb_mlp(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.uUqKtpAFtenspQYksdVQigMzkvnUGsAS).view(
            -1, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC
        )
        QknDLfOPGxCnhgwlIhYUagKdzScsoXIB = psppIXxCSyAsmPWaeuPeRLTPCwLBFIOe[rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.oRUZBArRhEMoqHYrzRoSroQpwOYCIvBp.view(-1)].view(  
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[0] * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1],
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[0] * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.nutobJTmWCYYpulsyYOoRWLklenNVeiu[1],
            -1,
        )  
        QknDLfOPGxCnhgwlIhYUagKdzScsoXIB = QknDLfOPGxCnhgwlIhYUagKdzScsoXIB.permute(
            2, 0, 1
        ).contiguous()  
        QknDLfOPGxCnhgwlIhYUagKdzScsoXIB = 16 * torch.sigmoid(QknDLfOPGxCnhgwlIhYUagKdzScsoXIB)
        tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW + QknDLfOPGxCnhgwlIhYUagKdzScsoXIB.unsqueeze(0)
        if KHpRlHOzblljQyskecSxzUuWZtneWwta is not None:
            ziQrOWJJTQePfPYDwdxSXQFLRreOKbvR = KHpRlHOzblljQyskecSxzUuWZtneWwta.BElyDvcGzbvMmmwmYRGBIJogcxsyYZSg[0]
            tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW.view(qNFDCcJCurubqgfYKilsAnvvBJnmzOLl // ziQrOWJJTQePfPYDwdxSXQFLRreOKbvR, ziQrOWJJTQePfPYDwdxSXQFLRreOKbvR, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts) + KHpRlHOzblljQyskecSxzUuWZtneWwta.unsqueeze(
                1
            ).unsqueeze(0)
            tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW.view(-1, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts)
            tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.softmax(tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW)
        else:
            tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.softmax(tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW)
        tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.tGJGoWYafTzhRETOOrClZjPpgXFZUOzU(tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW)
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = (tUmudCfKVwpeKVqJPkVQAwLriIrTDLbW @ powGafreWfwlSAqPpTpUhFgpFVqCPavl).transpose(1, 2).reshape(qNFDCcJCurubqgfYKilsAnvvBJnmzOLl, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.proj(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.hjPwvODBKgggBiPujNmVDnfSDUrbQIXL(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        return NECAaWUrFGIXcLimrerEYmxYIykQBfXb
    def UQQrTqiwAKPKtTyuidtRpsLNWekTFczd(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS) -> str:
        return (
            f"dim={self.dim}, window_size={self.window_size}, "
            f"pretrained_window_size={self.pretrained_window_size}, num_heads={self.num_heads}"
        )
    def epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, CkYaWzCjmffLyFAjukkxYTtrfjqQGpts):
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec = 0
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec += CkYaWzCjmffLyFAjukkxYTtrfjqQGpts * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk * 3 * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec += rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC * CkYaWzCjmffLyFAjukkxYTtrfjqQGpts * (rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk // rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC) * CkYaWzCjmffLyFAjukkxYTtrfjqQGpts
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec += rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC * CkYaWzCjmffLyFAjukkxYTtrfjqQGpts * CkYaWzCjmffLyFAjukkxYTtrfjqQGpts * (rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk // rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.WbSAuusmaEgbrureofeJezeXtfsVoscC)
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec += CkYaWzCjmffLyFAjukkxYTtrfjqQGpts * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk
        return epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec
class kdrkFBfJmtiPIYqxzEHXaLXyHdTuEzkK(nn.Module):
    r"""Swin Transformer BTYbrqbRvGGOjbsUzDMkWIBzNvOJUbif.
    Args:
        yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk (int): Number of input channels.
        IONObgzScAvEgELMQbHyEzZqOHcvcOTg (tuple[int]): Input resulotion.
        WbSAuusmaEgbrureofeJezeXtfsVoscC (int): Number of psnGIaaNNBTQhtdDvLAOAncJBcOCafNn QEnKImSSxUuBDHahcSgvZCYYpzjKVrVk.
        nutobJTmWCYYpulsyYOoRWLklenNVeiu (int): Window vqDBJgidQufnKyAltPYRqiKGjmztArDJ.
        VxEFwqRUZKQIODDttRLPjJQWwjYKIRso (int): Shift vqDBJgidQufnKyAltPYRqiKGjmztArDJ for SW-MSA.
        uDdUvEneYSYoIevRgfdDqvFctrSBFezp (float): Ratio of mlp hidden yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk.
        uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT (bool, optional): If True, add GlZreLQjBCiBptpFgmbsMbhjFlMgPVav learnable PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ oFxedobBnFbKeewIgTfUgblKziGvmndF, nyrzKxQtioheHIZujafABgijbCjrWhBU, value. Default: True
        UopxEzgpVJqkfTBuNkdEmNLRqPMUWpUu (float, optional): Dropout rate. Default: 0.0
        tGJGoWYafTzhRETOOrClZjPpgXFZUOzU (float, optional): Attention kcIxGCXrUvsLPSfmGoULGFzAthVmTXcA rate. Default: 0.0
        rzBOFNtNGPLXcyQbBkTWNeSrLkUVYuYg (float, optional): Stochastic JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX rate. Default: 0.0
        act_layer (nn.Module, optional): Activation rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ. Default: nn.GELU
        LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh (nn.Module, optional): Normalization rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ.  Default: nn.SeaDiaiECtgJbgiExWzpSnrizTosOUam
        fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn (int): Window vqDBJgidQufnKyAltPYRqiKGjmztArDJ in pre-training.
    def __init__(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, IONObgzScAvEgELMQbHyEzZqOHcvcOTg, yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk, LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh=nn.SeaDiaiECtgJbgiExWzpSnrizTosOUam):
        super().__init__()
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.IONObgzScAvEgELMQbHyEzZqOHcvcOTg = IONObgzScAvEgELMQbHyEzZqOHcvcOTg
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk = yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.reduction = nn.DhMcMyEvvzmWIEJojbQeGHlzfZKiPzHO(4 * yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk, 2 * yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk, PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB=False)
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.norm = LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh(2 * yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk)
    def lqBgIcSWZYylbCPjXksJWDguuSOqoPCJ(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, NECAaWUrFGIXcLimrerEYmxYIykQBfXb):
        gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV, vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.IONObgzScAvEgELMQbHyEzZqOHcvcOTg
        oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, iDkmScOFEQSvigzoQVmokXyFnStBqjCR, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh = NECAaWUrFGIXcLimrerEYmxYIykQBfXb.BElyDvcGzbvMmmwmYRGBIJogcxsyYZSg
        assert iDkmScOFEQSvigzoQVmokXyFnStBqjCR == gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV * vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ, "input feature has wrong size"
        assert gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV % 2 == 0 and vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ % 2 == 0, f"x size ({H}*{W}) are not even."
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = NECAaWUrFGIXcLimrerEYmxYIykQBfXb.view(oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV, vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)
        UBGvtPbFIPlcsBIwyWKuWMZeENGLMRAP = NECAaWUrFGIXcLimrerEYmxYIykQBfXb[:, 0::2, 0::2, :]  
        bokMHjGiefHKvQcAiJMaHIIOvPogwgnt = NECAaWUrFGIXcLimrerEYmxYIykQBfXb[:, 1::2, 0::2, :]  
        qRYyQjEAGRjtIxticvyLLasWEAHJzJrD = NECAaWUrFGIXcLimrerEYmxYIykQBfXb[:, 0::2, 1::2, :]  
        bhIpxBXekbOHXwSyfdqKHptgjtkdVVmj = NECAaWUrFGIXcLimrerEYmxYIykQBfXb[:, 1::2, 1::2, :]  
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = torch.cat([UBGvtPbFIPlcsBIwyWKuWMZeENGLMRAP, bokMHjGiefHKvQcAiJMaHIIOvPogwgnt, qRYyQjEAGRjtIxticvyLLasWEAHJzJrD, bhIpxBXekbOHXwSyfdqKHptgjtkdVVmj], -1)  
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = NECAaWUrFGIXcLimrerEYmxYIykQBfXb.view(oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, -1, 4 * AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)  
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.reduction(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.norm(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        return NECAaWUrFGIXcLimrerEYmxYIykQBfXb
    def UQQrTqiwAKPKtTyuidtRpsLNWekTFczd(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS) -> str:
        return f"input_resolution={self.input_resolution}, dim={self.dim}"
    def epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS):
        gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV, vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.IONObgzScAvEgELMQbHyEzZqOHcvcOTg
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec = (gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV // 2) * (vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ // 2) * 4 * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk * 2 * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec += gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV * vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk // 2
        return epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec
class UfzxIOJuREOajqPOZefZyUrSfxDATsJp(nn.Module):
    def __init__(
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS,
        yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk,
        IONObgzScAvEgELMQbHyEzZqOHcvcOTg,
        JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX,
        WbSAuusmaEgbrureofeJezeXtfsVoscC,
        nutobJTmWCYYpulsyYOoRWLklenNVeiu,
        uDdUvEneYSYoIevRgfdDqvFctrSBFezp=4.0,
        uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT=True,
        UopxEzgpVJqkfTBuNkdEmNLRqPMUWpUu=0.0,
        tGJGoWYafTzhRETOOrClZjPpgXFZUOzU=0.0,
        rzBOFNtNGPLXcyQbBkTWNeSrLkUVYuYg=0.0,
        LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh=nn.SeaDiaiECtgJbgiExWzpSnrizTosOUam,
        FNdFYgmARbySAmYyEvSINcVrOJlCpKfW=None,
        TkHgGRFhDYRqyKuFvQRlKbpOBXUaEDVU=False,
        fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn=0,
    ):
        super().__init__()
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk = yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.IONObgzScAvEgELMQbHyEzZqOHcvcOTg = IONObgzScAvEgELMQbHyEzZqOHcvcOTg
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX = JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.TkHgGRFhDYRqyKuFvQRlKbpOBXUaEDVU = TkHgGRFhDYRqyKuFvQRlKbpOBXUaEDVU
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.blocks = nn.ModuleList(
            [
                kdrkFBfJmtiPIYqxzEHXaLXyHdTuEzkK(
                    yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk=yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk,
                    IONObgzScAvEgELMQbHyEzZqOHcvcOTg=IONObgzScAvEgELMQbHyEzZqOHcvcOTg,
                    WbSAuusmaEgbrureofeJezeXtfsVoscC=WbSAuusmaEgbrureofeJezeXtfsVoscC,
                    nutobJTmWCYYpulsyYOoRWLklenNVeiu=nutobJTmWCYYpulsyYOoRWLklenNVeiu,
                    VxEFwqRUZKQIODDttRLPjJQWwjYKIRso=0 if (HCXmerBqIMuTscBONzTGKYapYSxWTYHo % 2 == 0) else nutobJTmWCYYpulsyYOoRWLklenNVeiu // 2,
                    uDdUvEneYSYoIevRgfdDqvFctrSBFezp=uDdUvEneYSYoIevRgfdDqvFctrSBFezp,
                    uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT=uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT,
                    UopxEzgpVJqkfTBuNkdEmNLRqPMUWpUu=UopxEzgpVJqkfTBuNkdEmNLRqPMUWpUu,
                    tGJGoWYafTzhRETOOrClZjPpgXFZUOzU=tGJGoWYafTzhRETOOrClZjPpgXFZUOzU,
                    rzBOFNtNGPLXcyQbBkTWNeSrLkUVYuYg=rzBOFNtNGPLXcyQbBkTWNeSrLkUVYuYg[HCXmerBqIMuTscBONzTGKYapYSxWTYHo]
                    if isinstance(rzBOFNtNGPLXcyQbBkTWNeSrLkUVYuYg, list)
                    else rzBOFNtNGPLXcyQbBkTWNeSrLkUVYuYg,
                    LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh=LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh,
                    fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn=fiCYgyBNCDAhHSiaUVDepERDHjeFKCnn,
                )
                for HCXmerBqIMuTscBONzTGKYapYSxWTYHo in range(JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX)
            ]
        )
        if FNdFYgmARbySAmYyEvSINcVrOJlCpKfW is not None:
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.FNdFYgmARbySAmYyEvSINcVrOJlCpKfW = FNdFYgmARbySAmYyEvSINcVrOJlCpKfW(
                IONObgzScAvEgELMQbHyEzZqOHcvcOTg, yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk=yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk, LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh=LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh
            )
        else:
            rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.FNdFYgmARbySAmYyEvSINcVrOJlCpKfW = None
    def lqBgIcSWZYylbCPjXksJWDguuSOqoPCJ(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, NECAaWUrFGIXcLimrerEYmxYIykQBfXb, x_size):
        for LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK in rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.blocks:
            if rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.TkHgGRFhDYRqyKuFvQRlKbpOBXUaEDVU:
                NECAaWUrFGIXcLimrerEYmxYIykQBfXb = vcSlHLxBcVodHmZrzACHLEJuENMXjWTG.vcSlHLxBcVodHmZrzACHLEJuENMXjWTG(LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK, NECAaWUrFGIXcLimrerEYmxYIykQBfXb, x_size)
            else:
                NECAaWUrFGIXcLimrerEYmxYIykQBfXb = LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK(NECAaWUrFGIXcLimrerEYmxYIykQBfXb, x_size)
        if rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.FNdFYgmARbySAmYyEvSINcVrOJlCpKfW is not None:
            NECAaWUrFGIXcLimrerEYmxYIykQBfXb = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.FNdFYgmARbySAmYyEvSINcVrOJlCpKfW(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)
        return NECAaWUrFGIXcLimrerEYmxYIykQBfXb
    def UQQrTqiwAKPKtTyuidtRpsLNWekTFczd(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS) -> str:
        return f"dim={self.dim}, input_resolution={self.input_resolution}, depth={self.depth}"
    def epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS):
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec = 0
        for LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK in rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.blocks:
            epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec += LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK.epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec()  
        if rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.FNdFYgmARbySAmYyEvSINcVrOJlCpKfW is not None:
            epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec += rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.FNdFYgmARbySAmYyEvSINcVrOJlCpKfW.epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec()
        return epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec
    def JqcPmNYlqxVAsmsVcrZNmyHdlAOHyYDC(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS):
        for LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK in rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.blocks:
            nn.init.constant_(LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK.norm1.PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB, 0)  
            nn.init.constant_(LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK.norm1.RXBOtvKSHQkBvdKDbckmnlphvVygYURP, 0)  
            nn.init.constant_(LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK.norm2.PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB, 0)  
            nn.init.constant_(LLiMCtLJBqUPDeOUdzNtdeEeLAsRdhQK.norm2.RXBOtvKSHQkBvdKDbckmnlphvVygYURP, 0)  
class wGvAtecRwaUEsRiKuHUaxqkCHvuCyqjL(nn.Module):
    r"""Image sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ Patch Embedding
    Args:
        FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE (int): Image vqDBJgidQufnKyAltPYRqiKGjmztArDJ.  Default: 224.
        HtvgnwOLVGNIRZoncKchqGwewNWrcyOO (int): Patch token vqDBJgidQufnKyAltPYRqiKGjmztArDJ. Default: 4.
        RnQeJtCTKIYBykxuudjZsYNxhhDUcfst (int): Number of input eLyJtroPthPCROYWyMphoIrGatNOOXCO channels. Default: 3.
        ImrGjiFVgoYlstXoXVYKbphbCLYUVMTp (int): Number of BJkSsAwbTZLfucgvGkDLcVEiRIlYJCmK projection pwTxzdNTJGMWEFORftJTEtPYMMiKwDuP channels. Default: 96.
        LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh (nn.Module, optional): Normalization rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ. Default: None
    Args:
        yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk (int): Number of input channels.
        IONObgzScAvEgELMQbHyEzZqOHcvcOTg (tuple[int]): Input BcSwNQTmUGuqaESGKyPNIfMVGtVTPcEr.
        JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX (int): Number of blocks.
        WbSAuusmaEgbrureofeJezeXtfsVoscC (int): Number of psnGIaaNNBTQhtdDvLAOAncJBcOCafNn QEnKImSSxUuBDHahcSgvZCYYpzjKVrVk.
        nutobJTmWCYYpulsyYOoRWLklenNVeiu (int): Local window vqDBJgidQufnKyAltPYRqiKGjmztArDJ.
        uDdUvEneYSYoIevRgfdDqvFctrSBFezp (float): Ratio of mlp hidden yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk.
        uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT (bool, optional): If True, add GlZreLQjBCiBptpFgmbsMbhjFlMgPVav learnable PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ oFxedobBnFbKeewIgTfUgblKziGvmndF, nyrzKxQtioheHIZujafABgijbCjrWhBU, value. Default: True
        UopxEzgpVJqkfTBuNkdEmNLRqPMUWpUu (float, optional): Dropout rate. Default: 0.0
        tGJGoWYafTzhRETOOrClZjPpgXFZUOzU (float, optional): Attention kcIxGCXrUvsLPSfmGoULGFzAthVmTXcA rate. Default: 0.0
        rzBOFNtNGPLXcyQbBkTWNeSrLkUVYuYg (float | tuple[float], optional): Stochastic JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX rate. Default: 0.0
        LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh (nn.Module, optional): Normalization rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ. Default: nn.SeaDiaiECtgJbgiExWzpSnrizTosOUam
        FNdFYgmARbySAmYyEvSINcVrOJlCpKfW (nn.Module | None, optional): LpwKTfRyOAITGEdvwhtCdMnNRMEQUkUG rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ at the lGLYgANCchGMWZfAOSVuiBulTGaEVaQM of the rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ. Default: None
        TkHgGRFhDYRqyKuFvQRlKbpOBXUaEDVU (bool): Whether sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ use checkpointing sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ PXhZDpeqZAdDBfrowpMPOPAWwzXhVAFM memory. Default: False.
        FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE: Input eLyJtroPthPCROYWyMphoIrGatNOOXCO vqDBJgidQufnKyAltPYRqiKGjmztArDJ.
        HtvgnwOLVGNIRZoncKchqGwewNWrcyOO: Patch vqDBJgidQufnKyAltPYRqiKGjmztArDJ.
        afjLwgjwIXGXlqqPLRgZmElxkEvNNGqp: The convolutional lPmJfojDSUTFirrgKPryiJRYyZOFajzZ before RJgGCfauvfBVooxMlJcnrJywZAxzDscI connection.
    def __init__(
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE=224, HtvgnwOLVGNIRZoncKchqGwewNWrcyOO=4, RnQeJtCTKIYBykxuudjZsYNxhhDUcfst=3, ImrGjiFVgoYlstXoXVYKbphbCLYUVMTp=96, LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh=None
    ):
        super().__init__()
        FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE = to_2tuple(FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE)
        HtvgnwOLVGNIRZoncKchqGwewNWrcyOO = to_2tuple(HtvgnwOLVGNIRZoncKchqGwewNWrcyOO)
        ZhBQpOcXqgRdyopMzHJslgylqnbfLHtC = [FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE[0] // HtvgnwOLVGNIRZoncKchqGwewNWrcyOO[0], FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE[1] // HtvgnwOLVGNIRZoncKchqGwewNWrcyOO[1]]  
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE = FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.HtvgnwOLVGNIRZoncKchqGwewNWrcyOO = HtvgnwOLVGNIRZoncKchqGwewNWrcyOO
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.ZhBQpOcXqgRdyopMzHJslgylqnbfLHtC = ZhBQpOcXqgRdyopMzHJslgylqnbfLHtC
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.num_patches = ZhBQpOcXqgRdyopMzHJslgylqnbfLHtC[0] * ZhBQpOcXqgRdyopMzHJslgylqnbfLHtC[1]
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.RnQeJtCTKIYBykxuudjZsYNxhhDUcfst = RnQeJtCTKIYBykxuudjZsYNxhhDUcfst
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.ImrGjiFVgoYlstXoXVYKbphbCLYUVMTp = ImrGjiFVgoYlstXoXVYKbphbCLYUVMTp
    def lqBgIcSWZYylbCPjXksJWDguuSOqoPCJ(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, NECAaWUrFGIXcLimrerEYmxYIykQBfXb, x_size):
        oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, QbOVoViABVXfgtBCCrsAyegyEKKYSFJC, AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh = NECAaWUrFGIXcLimrerEYmxYIykQBfXb.BElyDvcGzbvMmmwmYRGBIJogcxsyYZSg
        NECAaWUrFGIXcLimrerEYmxYIykQBfXb = NECAaWUrFGIXcLimrerEYmxYIykQBfXb.transpose(1, 2).view(oKoLNmqMHsUubaMUUnyDFEgClwoExDJu, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.ImrGjiFVgoYlstXoXVYKbphbCLYUVMTp, x_size[0], x_size[1])  
        return NECAaWUrFGIXcLimrerEYmxYIykQBfXb
    def epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS):
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec = 0
        return epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec
class kjruhryvXAQxnjJDeOXqTJbBrTkRFQSk(nn.Sequential):
    def __init__(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, xmbXivThLFnawFPAJvIDBztziWsaDyEE, num_feat):
        FTosLGldclAzaiNbwuLMIEtXfrZQpTnU = []
        if (xmbXivThLFnawFPAJvIDBztziWsaDyEE & (xmbXivThLFnawFPAJvIDBztziWsaDyEE - 1)) == 0:  
            for _ in range(int(math.DJwhOGBaLcOjmXnuwXMXOyhMtknqkKXL(xmbXivThLFnawFPAJvIDBztziWsaDyEE, 2))):
                FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.LcFcvNeYCKrBHlNkoWrkqdbxdkNCJBBK(num_feat, 4 * num_feat, 3, 1, 1))
                FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.PixelShuffle(2))
        elif xmbXivThLFnawFPAJvIDBztziWsaDyEE == 3:
            FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.LcFcvNeYCKrBHlNkoWrkqdbxdkNCJBBK(num_feat, 9 * num_feat, 3, 1, 1))
            FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.PixelShuffle(3))
        else:
            raise ValueError(
                f"scale {scale} is not supported. " "Supported scales: 2^n and 3."
            )
        super(kjruhryvXAQxnjJDeOXqTJbBrTkRFQSk, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS).__init__(*FTosLGldclAzaiNbwuLMIEtXfrZQpTnU)
class tenRnWRyCBSofZLXsFSRJmAicudTevCj(nn.Sequential):
    def __init__(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, xmbXivThLFnawFPAJvIDBztziWsaDyEE, num_feat):
        FTosLGldclAzaiNbwuLMIEtXfrZQpTnU = []
        if (xmbXivThLFnawFPAJvIDBztziWsaDyEE & (xmbXivThLFnawFPAJvIDBztziWsaDyEE - 1)) == 0:  
            for _ in range(int(math.DJwhOGBaLcOjmXnuwXMXOyhMtknqkKXL(xmbXivThLFnawFPAJvIDBztziWsaDyEE, 2))):
                FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.LcFcvNeYCKrBHlNkoWrkqdbxdkNCJBBK(num_feat, 4 * num_feat, 3, 1, 1))
                FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.PixelShuffle(2))
        elif xmbXivThLFnawFPAJvIDBztziWsaDyEE == 3:
            FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.LcFcvNeYCKrBHlNkoWrkqdbxdkNCJBBK(num_feat, 9 * num_feat, 3, 1, 1))
            FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.PixelShuffle(3))
        else:
            raise ValueError(
                f"scale {scale} is not supported. " "Supported scales: 2^n and 3."
            )
        super(tenRnWRyCBSofZLXsFSRJmAicudTevCj, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS).__init__(*FTosLGldclAzaiNbwuLMIEtXfrZQpTnU)
class VgiPcdFmOGbVykMkVjJgYVmmCBCJZMQH(nn.Sequential):
    def __init__(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS, xmbXivThLFnawFPAJvIDBztziWsaDyEE, num_feat, num_out_ch, IONObgzScAvEgELMQbHyEzZqOHcvcOTg=None):
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.num_feat = num_feat
        rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.IONObgzScAvEgELMQbHyEzZqOHcvcOTg = IONObgzScAvEgELMQbHyEzZqOHcvcOTg
        FTosLGldclAzaiNbwuLMIEtXfrZQpTnU = []
        FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.LcFcvNeYCKrBHlNkoWrkqdbxdkNCJBBK(num_feat, (xmbXivThLFnawFPAJvIDBztziWsaDyEE**2) * num_out_ch, 3, 1, 1))
        FTosLGldclAzaiNbwuLMIEtXfrZQpTnU.append(nn.PixelShuffle(xmbXivThLFnawFPAJvIDBztziWsaDyEE))
        super(VgiPcdFmOGbVykMkVjJgYVmmCBCJZMQH, rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS).__init__(*FTosLGldclAzaiNbwuLMIEtXfrZQpTnU)
    def epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec(rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS):
        gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV, vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ = rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.IONObgzScAvEgELMQbHyEzZqOHcvcOTg  
        epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec = gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV * vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ * rmBxqCKJkHuPIHNivpdAAgzvrGlNKdVS.num_feat * 3 * 9
        return epXNvUYhxcvAnkNxLYKoeNLGkQZyoeec
class HVHcKcHkebMPurTTByRqOJzvrXFSRebi(nn.Module):
    r"""HVHcKcHkebMPurTTByRqOJzvrXFSRebi
        A PyTorch impl of : `HVHcKcHkebMPurTTByRqOJzvrXFSRebi: SwinV2 Transformer for Compressed Image Super-Resolution and Restoration`.
    Args:
        FRfCpqDfnuqJOdWObzdWdyzDuFpQbGQE (int | tuple(int)): Input eLyJtroPthPCROYWyMphoIrGatNOOXCO vqDBJgidQufnKyAltPYRqiKGjmztArDJ. Default 64
        HtvgnwOLVGNIRZoncKchqGwewNWrcyOO (int | tuple(int)): Patch vqDBJgidQufnKyAltPYRqiKGjmztArDJ. Default: 1
        RnQeJtCTKIYBykxuudjZsYNxhhDUcfst (int): Number of input eLyJtroPthPCROYWyMphoIrGatNOOXCO channels. Default: 3
        ImrGjiFVgoYlstXoXVYKbphbCLYUVMTp (int): Patch FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu dimension. Default: 96
        depths (tuple(int)): Depth of each Swin Transformer rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ.
        WbSAuusmaEgbrureofeJezeXtfsVoscC (tuple(int)): Number of psnGIaaNNBTQhtdDvLAOAncJBcOCafNn QEnKImSSxUuBDHahcSgvZCYYpzjKVrVk in different YLFvlrIxIOsplmnxmtPcOLtJTpiskWMv.
        nutobJTmWCYYpulsyYOoRWLklenNVeiu (int): Window vqDBJgidQufnKyAltPYRqiKGjmztArDJ. Default: 7
        uDdUvEneYSYoIevRgfdDqvFctrSBFezp (float): Ratio of mlp hidden yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu yNArbRJyZEdZIsbNkxRhLcwhRbcXdsNk. Default: 4
        uGtxGIAnzLWWZnlGFIWJvzLZRYfyFdwT (bool): If True, add GlZreLQjBCiBptpFgmbsMbhjFlMgPVav learnable PvdyIPYzYuxTGYQjZbTucTrRGHTQkavB sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ oFxedobBnFbKeewIgTfUgblKziGvmndF, nyrzKxQtioheHIZujafABgijbCjrWhBU, value. Default: True
        drop_rate (float): Dropout rate. Default: 0
        attn_drop_rate (float): Attention kcIxGCXrUvsLPSfmGoULGFzAthVmTXcA rate. Default: 0
        drop_path_rate (float): Stochastic JtnlCSDzHOgtbZVTfQMidKPjmOFZfzZX rate. Default: 0.1
        LSMbVVMwSksHBLrtUDiFhcEHyPIDcKoh (nn.Module): Normalization rmOubEJgfxmJuwTevhKPPVPDYGHXWRFZ. Default: nn.SeaDiaiECtgJbgiExWzpSnrizTosOUam.
        ape (bool): If True, add absolute position FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ the YBkyOiHLPkzbgIAzSqhyviJVGfxblkPn FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu. Default: False
        patch_norm (bool): If True, add DvCWYnpMIBQxXcLuPCRaTuuQvPYPGGWh after YBkyOiHLPkzbgIAzSqhyviJVGfxblkPn FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu. Default: True
        TkHgGRFhDYRqyKuFvQRlKbpOBXUaEDVU (bool): Whether sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ use checkpointing sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ PXhZDpeqZAdDBfrowpMPOPAWwzXhVAFM memory. Default: False
        VFbOpUjlPHhNgAvxtBCPRqDCJyPQDVlx: Upscale ZOCdfHhxSDyKGnmTCFXPxBveAfxLOShd. 2/3/4/8 for eLyJtroPthPCROYWyMphoIrGatNOOXCO SR, 1 for denoising and compress artifact reduction
        img_range: Image range. 1. or 255.
        upsampler: The reconstruction reconstruction FRIBQCDfDDxIonplwxvPCicvOmmOgYPC. 'pixelshuffle'/'pixelshuffledirect'/'nearest+conv'/None
        afjLwgjwIXGXlqqPLRgZmElxkEvNNGqp: The convolutional lPmJfojDSUTFirrgKPryiJRYyZOFajzZ before RJgGCfauvfBVooxMlJcnrJywZAxzDscI connection. '1conv'/'3conv'
