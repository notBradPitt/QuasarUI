    see https://github.com/MishaLaskin/vqvae/blob/d761a999e2267766400dc646d82d3ac3657771d4/models/quantizer.py
    ____________________________________________
    Discretization bottleneck part of the VQ-VAE.
    Inputs:
    - n_e : FCVsdRzGunasBiYAXHkNdLEMUdcXuHLD of CQDUGzeqFbhJuPQwIUXzCwYMkQNapRqX
    - e_dim : dimension of FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu
    - PgoraROQSYILTGDWEfTGXrsnUljVRBUG : commitment cost used in GtnkLyvfmiRPrwSQJfyYiKxybcBdUius term, PgoraROQSYILTGDWEfTGXrsnUljVRBUG * ||z_e(NECAaWUrFGIXcLimrerEYmxYIykQBfXb)-sg[dgvKdkEDrMSdkCaRxfkDNVbaXWUetgtO]||^2
    _____________________________________________
        Inputs the pwTxzdNTJGMWEFORftJTEtPYMMiKwDuP of the encoder network AVjwZelSxiiANPDkDuRKTIIJYnqgQaTi and maps it sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ GlZreLQjBCiBptpFgmbsMbhjFlMgPVav discrete
        one-hot vector that is the index of the closest FPlsdAwlwymuCRSvDfaEeNjwKAgUwgXu vector e_j
        AVjwZelSxiiANPDkDuRKTIIJYnqgQaTi (continuous) -> z_q (discrete)
        AVjwZelSxiiANPDkDuRKTIIJYnqgQaTi.BElyDvcGzbvMmmwmYRGBIJogcxsyYZSg = (IEfFCfCTfyvJvVHxiDPsIOnopGWoUJhP, EiApFIHKVDYyxTYijPXtjyqRuQDlhpED, yhGxnlfJCKaDHyDtiYhJHxHFcooDKiMM, QfeoFYGsEQNWblsqXsRKWQpzeXgWujaz)
        quantization pipeline:
            1. get encoder input (oKoLNmqMHsUubaMUUnyDFEgClwoExDJu,AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh,gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV,vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ)
            2. flatten input sAkaPAxVAyVwUBdNgBaxCKHpzBJvSayZ (oKoLNmqMHsUubaMUUnyDFEgClwoExDJu*gFdyNTfDqQDeXijWZEnTSFKJXHMWaEiV*vFYBIMOEtqWwjvpBeeDFaIqTrgSbzULJ,AHoGYMpsqEtOaZpAamJqoHqHvnlwZSRh)
